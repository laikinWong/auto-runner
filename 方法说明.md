# basecase.py 方法说明文档

## 🧱 BaseBrowser（浏览器控制方法）

| 方法名 | 功能说明 |
|--------|----------|
| `open_browser()` | 启动浏览器（自动根据 config 设置） |
| `create_browser(browser_type, headless)` | 创建浏览器，返回 browser、context、page |
| `reset_browser_context()` | 重置上下文，清除缓存和 cookie |
| `close()` | 关闭浏览器 |
| `open_new_page(tag)` | 新建标签页并设置标签 |
| `find_page(tag, index, title, url)` | 查找页面（多种方式） |
| `switch_to_page(tag, index, title, url)` | 切换到指定页面 |
| `close_page(tag, index, title, url)` | 关闭指定页面 |

---

## 🌐 PageMixin（页面级操作）

| 方法名 | 功能说明 |
|--------|----------|
| `open_url(url, wait_until, timeout)` | 打开网页 |
| `refresh()` | 刷新页面 |
| `go_back()` | 浏览器后退 |
| `save_page_img(name, path)` | 截图保存 |
| `scroll_to_height(height)` | 页面滚动 |
| `execute_script(script, *args)` | 执行 JS 脚本 |

---

## 🧩 LocatorMixin（页面元素操作）

| 方法名 | 功能说明 |
|--------|----------|
| `fill_value(locator, value)` | 填充输入框 |
| `click_ele(locator, button, count)` | 点击元素 |
| `clear_value(locator)` | 清除输入框 |
| `set_checked(locator)` | 设置为选中状态 |
| `hover(locator)` | 鼠标悬停 |
| `focus_element(locator)` | 聚焦元素 |
| `select_option(locator, value)` | 选择下拉选项 |
| `type_value(locator, value)` | 模拟键盘输入 |
| `long_click_element(locator, delay)` | 长按元素 |
| `drag_and_drop(start, end)` | 拖拽元素 |

---

## ⏳ WaitMixin（等待操作）

| 方法名 | 功能说明 |
|--------|----------|
| `set_default_timeout(timeout)` | 设置全局等待时间 |
| `wait_for_time(timeout)` | 强制等待 |
| `wait_for_load()` | 等待页面加载完成 |
| `wait_for_network()` | 等待网络请求完成 |
| `wait_for_element(locator)` | 等待元素出现 |

---

## 🖱️ MouseMixin（鼠标和键盘）

| 方法名 | 功能说明 |
|--------|----------|
| `mouse_click(x, y)` | 点击指定坐标 |
| `move_mouse(x, y)` | 鼠标移动 |
| `mouse_down(button)` | 鼠标按下 |
| `mouse_up(button)` | 鼠标抬起 |
| `press_key(key)` | 按下指定键 |
| `press_type(keys)` | 输入文本 |

---

## 🪟 IFrameMixin（iframe 内部操作）

| 方法名 | 功能说明 |
|--------|----------|
| `frame_fill_value(frame, locator, value)` | iframe 内输入 |
| `frame_click_element(frame, locator)` | iframe 内点击 |
| `frame_hover(frame, locator)` | iframe 内悬停 |
| `frame_focus_element(frame, locator)` | iframe 内聚焦 |
| `frame_select_option(frame, locator, value)` | iframe 内选项 |
| `frame_type_value(frame, locator, value)` | iframe 内输入 |
| `frame_long_click_element(frame, locator)` | iframe 内长按 |
| `frame_drag_and_drop(frame, start, end)` | iframe 内拖拽 |

---

## ✅ AssertMixin（断言方法）

| 方法名 | 功能说明 |
|--------|----------|
| `assert_page_title(expect, is_equal)` | 断言页面标题 |
| `assert_page_url(expect, is_equal)` | 断言 URL |
| `except_to_have_value(locator, expect, is_equal)` | 断言元素 value |
| `except_to_have_text(locator, expect, is_equal)` | 断言元素文本 |
| `except_to_have_attribute(locator, name, value, is_equal)` | 断言属性 |
| `except_to_be_visible(locator, index)` | 断言元素可见 |
| `except_to_be_hidden(locator, index)` | 断言元素不可见 |
| `except_to_be_enabled(locator, index)` | 断言元素可用 |
| `except_to_be_disabled(locator, index)` | 断言元素不可用 |
| `except_to_be_checked(locator, index)` | 断言元素被选中 |
| `except_to_be_empty(locator, index)` | 断言元素为空 |
| `except_to_be_editable(locator, index)` | 断言元素可编辑 |
| `except_to_be_focused(locator, index)` | 断言元素聚焦 |

---

## 📦 BaseCase 专属方法

| 方法名 | 功能说明 |
|--------|----------|
| `perform(step)` | 根据步骤 dict 自动执行对应方法（关键词驱动） |
| `replace_params(params)` | 替换参数中的变量占位符 |

---
